<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="css/macos.theme.css">
	<!--	<link rel="import" href="node_modules/xel/xel.min.html">-->
	<!--
<link rel="stylesheet" href="css/photon.css">-->
	<link rel="stylesheet" href="css/app.css">
	<!--	<link rel="stylesheet" href="css/text_menu.css">-->
	<link rel="stylesheet" href="css/gridlex.min.css">
	<link rel="stylesheet" href="css/pretty.min.css">

	<!--	this are the css an js files from the angular project-->

	<!--	<link rel='stylesheet prefetch' href='css/bootstrap.min.css'>-->
	<link rel='stylesheet prefetch' href='css/font-awesome.min.css'>

	<link rel="stylesheet" href="css/style.css">
	<!--	<script src="css/ruler.css"></script>-->



	<!-- Insert this line above script imports  -->
	<script>
		if (typeof module === 'object') {
			window.module = module;
			module = undefined;
		}
	</script>




	<!--    <script src='js/xel.min.js'></script>-->
	<script src='js/jquery.min.js'></script>
	<script src='js/jquery.nestable.js'></script>
	<script src='js/jquery-ui.min.js'></script>
	<script src='js/fabric.min.js'></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/document-register-element/0.2.1/document-register-element.js"></script>

	<script src='js/xel.min.js'></script>

	<script src='js/angular.min.js'></script>
	<script src="https://rawgit.com/eee-c/angular-bind-polymer/master/angular_bind_polymer.js"></script>


	<script src='node_modules/angular-ui-sortable/dist/sortable.min.js'></script>
	<script src='js/aligning_guidelines.js'></script>
	<script src='js/centering_guidelines.js'></script>


	<script src="js/utils.js"></script>
	<script src="js/app_config.js"></script>
	<script src="js/controller.js"></script>
	<script src="js/keymaster.js"></script>

	<script src="lib/font_definitions.js"></script>
	<script src="js/paster.js"></script>

	<!-- Ruler script here – https://github.com/MrFrankel/ruler  -->
	<link rel="stylesheet" href="node_modules/ruler.js/dist/ruler.min.css">
	<script src="node_modules/ruler.js/dist/ruler.min.js"></script>
	<script src="js/ruler_demo.js"></script>






	<!-- Insert this line after script imports -->
	<script>
		if (window.module) module = window.module;
	</script>

	<!-- dummy function – toggle left panel -->

	<script>
		function toggleLayers() {
			var x = document.getElementById('layers');
			if (x.style.display === 'none') {
				x.style.display = 'block';
			} else {
				x.style.display = 'none';
			}
		}

		function toggleInspector() {
			var x = document.getElementById('inspector');
			if (x.style.display === 'none') {
				x.style.display = 'block';
			} else {
				x.style.display = 'none';
			}
		}
	</script>




</head>



<body style="background: rgba(0, 0, 0, 0.0);" ng-app="kitchensink" ng-controller="CanvasControls">
	<div class="window" style="background: rgba(255, 255, 255, 0.0)">
		<header class="toolbar toolbar-header">
			<h1 class="title">Untitled</h1>

			<div class="toolbar-actions">
				<x-box class="middle">
					<x-buttons tracking="2">
						<x-button skin="iconic" onclick="toggleLayers()" toggled>
							<x-box vertical>
								<x-icon name="layers"></x-icon>
								<x-label>Layers</x-label>
							</x-box>
						</x-button>

						<x-button skin="iconic">
							<x-box vertical>
								<x-icon name="pages"></x-icon>
								<x-label>Pages</x-label>
							</x-box>
						</x-button>
					</x-buttons>

					<x-buttons tracking="1">
						<x-button skin="iconic" ng-click="addTextbox()">
							<x-box vertical>
								<x-icon name="title"></x-icon>
								<x-label>Add Text</x-label>
							</x-box>
						</x-button>
						
						<x-button skin="iconic" ng-click="loadImage()">
							<x-box vertical>
								<x-icon name="photo"></x-icon>
								<x-label>Add Image</x-label>
							</x-box>
						</x-button>

						<x-button skin="iconic">
							<x-box vertical>
								<x-icon name="add-box"></x-icon>
								<x-label>Insert Element</x-label>
							</x-box>
							<x-menu>
								<x-menuitem ng-click="addTextbox()">
									<x-icon name="title"></x-icon>
									<x-label>Add Textfield</x-label>
								</x-menuitem>

								<x-menuitem ng-click="loadImage()">
									<x-icon name="photo"></x-icon>
									<x-label>Add Image...</x-label>
								</x-menuitem>

								<x-menuitem>
									<x-icon name="videocam"></x-icon>
									<x-label>Add Video...</x-label>
								</x-menuitem>

								<hr>

								<x-menuitem ng-click="addRect()">
									<x-icon name="content-copy"></x-icon>
									<x-label>Add Rectangle</x-label>
								</x-menuitem>

								<x-menuitem ng-click="addRoundRect()">
									<x-icon name="crop-square"></x-icon>
									<x-label>Add Rounded Rectangle</x-label>
								</x-menuitem>

								<x-menuitem ng-click="addCircle()">
									<x-icon name="panorama-fish-eye"></x-icon>
									<x-label>Add Circle</x-label>
								</x-menuitem>

								<x-menuitem ng-click="addTriangle()">
									<x-icon name="details"></x-icon>
									<x-label>Add Triangle</x-label>
								</x-menuitem>

								<x-menuitem ng-click="addLine()">
									<x-icon name="remove"></x-icon>
									<x-label>Add Line</x-label>
								</x-menuitem>

							</x-menu>
						</x-button>

					</x-buttons>

					<x-buttons tracking="1">
						<x-button skin="iconic" toggled>
							<x-box vertical>
								<x-icon name="edit"></x-icon>
								<x-label>Page Editor</x-label>
							</x-box>
						</x-button>

						<x-button skin="iconic" disabled>
							<x-box vertical>
								<x-icon name="actions" iconset="images/icons.svg"></x-icon>
								<x-label>Actions Editor</x-label>
							</x-box>
						</x-button>



						<x-button skin="iconic" disabled>
							<x-box vertical>
								<x-icon name="view-module"></x-icon>
								<x-label>Page Flow</x-label>
							</x-box>
						</x-button>

					</x-buttons>

					<x-buttons tracking="1">
						<x-button skin="iconic" disabled>
							<x-box vertical>
								<x-icon name="visibility"></x-icon>
								<x-label>Project Preview</x-label>
							</x-box>
						</x-button>

						<x-button skin="iconic" disabled>
							<x-box vertical>
								<x-icon name="code"></x-icon>
								<x-label>Code View</x-label>
							</x-box>
						</x-button>

					</x-buttons>

					<x-buttons tracking="2">
						<x-button skin="iconic" onclick="toggleInspector()" toggled>
							<x-box vertical>
								<x-icon name="settings"></x-icon>
								<x-label>Inspector</x-label>
							</x-box>
						</x-button>

						<x-button skin="iconic" disabled>
							<x-box vertical>
								<x-icon name="image"></x-icon>
								<x-label>Asset Library</x-label>
							</x-box>
						</x-button>

						<x-button skin="iconic" disabled>
							<x-box vertical>
								<x-icon name="get-app"></x-icon>
								<x-label>Export</x-label>
							</x-box>
						</x-button>

					</x-buttons>
				</x-box>






			</div>
		</header>

		<div class="window-content">
			<div class="pane-group">
				<div id="layers" class="pane-sm sidebar" ng-controller="LeftTabsCtrl">

					<x-box>
						<x-buttons tracking="1">
							<x-button ng-repeat="tab in tabs" skin="tabnav" ng-class="{active:isActiveTab(tab.url)}" ng-click="onClickTab(tab)">
								<x-icon name="{{tab.micon}}"></x-icon>

							</x-button>
						</x-buttons>
					</x-box>
					<hr>
					<div ng-include="currentTab" ng-controller="LayersController"></div>



				</div>
				<div class="pane content-empty image-builder-container">

					<!--
					<div class="controls">
						<label>Use WebGl
							<input type="checkbox" id="webgl" checked="">
						</label>
						<div id="bench"></div>
						<p>
							<label><span>Grayscale:</span>
								<input type="checkbox" id="grayscale">
							</label>
							<br>
							<label><span>Avg.</span>
								<input type="radio" id="average" name="grayscale">
							</label>
							<label><span>Lum.</span>
								<input type="radio" id="lightness" name="grayscale">
							</label>
							<label><span>Light.</span>
								<input type="radio" id="luminosity" name="grayscale">
							</label>
						</p>
						<p>
							<label><span>Invert:</span>
								<input type="checkbox" id="invert">
							</label>
						</p>
						<p>
							<label>Colormatrix filters:</label>
						</p>
						<p>
							<label><span>Sepia:</span>
								<input type="checkbox" id="sepia">
							</label>
						</p>
						<p>
							<label><span>Black/White:</span>
								<input type="checkbox" id="blackwhite">
							</label>
						</p>
						<p>
							<label><span>Brownie:</span>
								<input type="checkbox" id="brownie">
							</label>
						</p>
						<p>
							<label><span>Vintage:</span>
								<input type="checkbox" id="vintage">
							</label>
						</p>
						<p>
							<label><span>Kodachrome:</span>
								<input type="checkbox" id="kodachrome">
							</label>
						</p>
						<p>
							<label><span>Technicolor:</span>
								<input type="checkbox" id="technicolor">
							</label>
						</p>
						<p>
							<label><span>Polaroid:</span>
								<input type="checkbox" id="polaroid">
							</label>
						</p>

						<p>
							<label><span>Brightness:</span>
								<input type="checkbox" id="brightness">
							</label>
							<br>
							<label>Value:
								<input type="range" id="brightness-value" value="0.1" min="-1" max="1" step="0.003921">
							</label>
						</p>

						<p>
							<label><span>Contrast:</span>
								<input type="checkbox" id="contrast">
							</label>
							<br>
							<label>Value:
								<input type="range" id="contrast-value" value="0" min="-1" max="1" step="0.003921">
							</label>
						</p>
						<p>
							<label><span>Saturation:</span>
								<input type="checkbox" id="saturation">
							</label>
							<br>
							<label>Value:
								<input type="range" id="saturation-value" value="0" min="-1" max="1" step="0.003921">
							</label>
						</p>
						<p>
							<label><span>Hue:</span>
								<input type="checkbox" id="hue">
							</label>
							<br>
							<label>Value:
								<input type="range" id="hue-value" value="0" min="-2" max="2" step="0.002">
							</label>
						</p>
						<p>
							<label><span>Noise:</span>
								<input type="checkbox" id="noise">
							</label>
							<br>
							<label>Value:
								<input type="range" id="noise-value" value="100" min="0" max="1000">
							</label>
						</p>
						<p>
							<label><span>Blur:</span>
								<input type="checkbox" id="blur">
							</label>
							<br>
							<label>Value:
								<input type="range" id="blur-value" value="0.1" min="0" max="1" step="0.01">
							</label>
						</p>

						<p>
							<label><span>Blend Color:</span>
								<input type="checkbox" id="blend">
							</label>
							<br>
							<label>Mode:</label>
							<select id="blend-mode" name="blend-mode">
								<option selected="" value="add">Add</option>
								<option value="diff">Diff</option>
								<option value="subtract">Subtract</option>
								<option value="multiply">Multiply</option>
								<option value="screen">Screen</option>
								<option value="lighten">Lighten</option>
								<option value="darken">Darken</option>
								<option value="overlay">Overlay</option>
								<option value="exclusion">Exclusion</option>
								<option value="tint">Tint</option>
							</select>
							<br>
							<label>Color:
								<input type="color" id="blend-color" value="#00f900">
							</label>
							<br>
							<label>Alpha:
								<input type="range" id="blend-alpha" min="0" max="1" value="1" step="0.01">
							</label>
							<br>
						</p>
						<label><span>Blend Image:</span>
							<input type="checkbox" id="blend-image">
						</label>
						<br>
						<label>Mode:</label>
						<select id="blend-image-mode" name="blend-image-mode">
							<option selected="" value="multiply">Multiply</option>
							<option value="mask">Mask</option>
						</select>
						<br>
						<label>Alpha:
							<input type="range" id="blend-image-alpha" min="0" max="1" value="1" step="0.01">
						</label>
						<br>
						<p></p>
					</div>
-->


					<div id="wrapper" class='image-builder' parent-click="fabric.deactivateAll()">
						<div class='fabric-container'>
							<canvas id="canvas" width="1024" height="768"></canvas>
						</div>
					</div>
				</div>

				<div id="inspector" class="pane-right sidebar" ng-controller="RightTabsCtrl">

					<x-box>
						<x-buttons tracking="1">
							<x-button ng-repeat="tab in tabs" skin="tabnav" ng-class="{active:isActiveTab(tab.url)}" ng-click="onClickTab(tab)">
								<!--								<x-icon name="{{tab.ticon}}" iconset="{{tab.custom}}"></x-icon>-->
								<x-icon name="{{tab.micon}}"></x-icon>

							</x-button>
						</x-buttons>
					</x-box>
					<hr>




					<div ng-include="currentTab" class="inner"></div>



				</div>
			</div>
		</div>
		<footer class="toolbar toolbar-footer" ng-controller="CanvasControls">
			<h1 class="title">{{ size.name }}</h1>
		</footer>
	</div>

	<script>
		var kitchensink = {};
		var canvas = new fabric.Canvas('canvas', {
			backgroundColor: "#FFFFFF",
			selectionColor: "rgba(0, 108, 223, 0.05)",
			selectionBorderColor: "rgba(0, 108, 223, 0.3)",
			selectionDashArray: [2, 2]
		});
		initAligningGuidelines(canvas);
		initCenteringGuidelines(canvas);

	

		// create grid and snap to grid


		//canvas.on('object:moving', function(options) {
		//  options.target.set({
		//    left: Math.round(options.target.left / gridSize) * gridSize,
		//    top: Math.round(options.target.top / gridSize) * gridSize
		//  });
		//});

		// ------------------

		/*
		getting some test data
		*/

		canvas.on('object:scaling', onObjectModification);
		canvas.on('object:moving', onObjectModification);
		canvas.on('object:rotating', onObjectModification);
		canvas.on('object:selected', onObjectModification);

		function onObjectModification(e) {
			var activeObject = e.target;
			if (!activeObject) {
				return;
			}
			var canvasWidth = canvas.width;
			var canvasHeight = canvas.height;
			var reachedLimit = false;
			var objectLeft = Math.round(activeObject.left);
			var objectTop = Math.round(activeObject.top);
			var objectAngle = Math.round(activeObject.angle * 10) / 10;
			var objectWidth = Math.round(activeObject.width);
			var objectHeight = Math.round(activeObject.height);
			var objWidth = Math.round(activeObject.width * activeObject.scaleX);
			var objHeight = Math.round(activeObject.height * activeObject.scaleY);
			//	console.log(canvasWidth, canvasHeight, objectLeft, objectTop, objectAngle, objectWidth, objectHeight, objWidth, objHeight);


		}


		//use scale width height insted of scleX scaleY

		//fabric.Canvas.prototype.preserveObjectStacking = true;
		//  // Resize objects programmatically to keep stroke width constant
		//  fabric.Object.prototype.resizeToScale = function (scaleX, scaleY, belongsToGroup) {
		//    var objectScaleX = scaleX || this.scaleX;
		//    var objectScaleY = scaleY || this.scaleY;
		//    switch (this.type) {
		//      case 'ellipse':
		//        this.rx *= objectScaleX;
		//        this.ry *= objectScaleY;
		//        this.width = this.rx * 2;
		//        this.height = this.ry * 2;
		//        this.scaleX = 1;
		//        this.scaleY = 1;
		//        if (belongsToGroup) {
		//          // Object's left and top are relative to group's position so let's
		//          // update them too
		//          this.left *= objectScaleX;
		//          this.top *= objectScaleY;
		//        }
		//        break;
		//      case 'rect':
		//      case 'triangle':
		//      case 'group':
		//        this.width *= objectScaleX;
		//        this.height *= objectScaleY;
		//        this.scaleX = 1;
		//        this.scaleY = 1;
		//        if (belongsToGroup) {
		//          // Object's left and top are relative to group's position so let's
		//          // update them too
		//          this.left *= objectScaleX;
		//          this.top *= objectScaleY;
		//        }
		//        break;
		//      default:
		//        // Do nothing
		//    }
		//  };
		//    
		//  // Observe object scale so we can keep strokeWidth constant
		//  canvas.on('object:scaling', function (e) {
		//    if (e.target.type === 'group') {
		//      // Group scaleX and scaleY values
		//      var groupScaleX = e.target.scaleX;
		//      var groupScaleY = e.target.scaleY;
		//      // Resize group first
		//      e.target.resizeToScale();
		//      // Resize each item of the group using groupScale[X-Y]
		//      e.target._objects.forEach(function (object) {
		//        object.resizeToScale(groupScaleX, groupScaleY, true);
		//      });
		//    } else {
		//      e.target.resizeToScale();
		//    }
		//  });
		//		


		/*
				undo and redo functions – this should be integrated in the controllers later on
		*/
		var _config = {
			canvasState: [],
			currentStateIndex: -1,
			undoStatus: false,
			redoStatus: false,
			undoFinishedStatus: 1,
			redoFinishedStatus: 1,

		};
		canvas.on(
			'object:modified',
			function() {
				updateCanvasState();
			}
		);


		canvas.on(
			'object:added',
			function() {
				updateCanvasState();
			}
		);

		canvas.on(
			'object:removed',
			function() {
				updateCanvasState();
			}
		);


		canvas.on(
			'selection:created',
			function() {
				updateCanvasState();
			}
		);

		var updateCanvasState = function() {
			if ((_config.undoStatus == false && _config.redoStatus == false)) {
				var jsonData = canvas.toJSON();
				var canvasAsJson = JSON.stringify(jsonData);
				if (_config.currentStateIndex < _config.canvasState.length - 1) {
					var indexToBeInserted = _config.currentStateIndex + 1;
					_config.canvasState[indexToBeInserted] = canvasAsJson;
					var numberOfElementsToRetain = indexToBeInserted + 1;
					_config.canvasState = _config.canvasState.splice(0, numberOfElementsToRetain);
				} else {
					_config.canvasState.push(canvasAsJson);
				}
				_config.currentStateIndex = _config.canvasState.length - 1;
				if ((_config.currentStateIndex == _config.canvasState.length - 1) && _config.currentStateIndex != -1) {}
			}
		}


		var undo = function() {
			if (_config.undoFinishedStatus) {
				if (_config.currentStateIndex == -1) {
					_config.undoStatus = false;
				} else {
					if (_config.canvasState.length >= 1) {
						_config.undoFinishedStatus = 0;
						if (_config.currentStateIndex != 0) {
							_config.undoStatus = true;
							canvas.loadFromJSON(_config.canvasState[_config.currentStateIndex - 1], function() {
								var jsonData = JSON.parse(_config.canvasState[_config.currentStateIndex - 1]);
								canvas.renderAll();
								_config.undoStatus = false;
								_config.currentStateIndex -= 1;
								if (_config.currentStateIndex !== _config.canvasState.length - 1) {}
								_config.undoFinishedStatus = 1;
							});
						} else if (_config.currentStateIndex == 0) {
							canvas.clear();
							_config.undoFinishedStatus = 1;
							_config.currentStateIndex -= 1;
						}
					}
				}
			}
		}

		var redo = function() {
			if (_config.redoFinishedStatus) {
				if ((_config.currentStateIndex == _config.canvasState.length - 1) && _config.currentStateIndex != -1) {} else {
					if (_config.canvasState.length > _config.currentStateIndex && _config.canvasState.length != 0) {
						_config.redoFinishedStatus = 0;
						_config.redoStatus = true;
						canvas.loadFromJSON(_config.canvasState[_config.currentStateIndex + 1], function() {
							var jsonData = JSON.parse(_config.canvasState[_config.currentStateIndex + 1]);
							canvas.renderAll();
							_config.redoStatus = false;
							_config.currentStateIndex += 1;
							if (_config.currentStateIndex != -1) {}
							_config.redoFinishedStatus = 1;
							if ((_config.currentStateIndex == _config.canvasState.length - 1) && _config.currentStateIndex != -1) {}
						});
					}
				}
			}
		}
	</script>

	<script>
		require('electron').ipcRenderer.on('ping', function(event, message) {
			console.log(message); // Prints "whoooooooh!"
		});

		/*		require('electron').ipcRenderer.on('file-save', function(event, message) {
					console.log('save file...');
					removeSelected();// Prints "whoooooooh!"
				});*/

		require('electron').ipcRenderer.on('delete', function() {
			remove(); // Prints "whoooooooh!"
		});
	</script>

	<script>
		key('⌘+c, ctrl+c', function() {
			copy();
		});
		key('⌘+v, ctrl+v', function() {
			paste();
		});
		key('backspace, del', function() {
			remove();
		});
		key('⌘+g', function() {
			group();
		});
		key('⌘+u', function() {
			ungroup();
		});
		key('⌘+z', function() {
			undo();
		});
		key('shift+⌘+z', function() {
			redo();
		});
	</script>

	<!--
	<script>
		(function() {
				// manually initialize 2 filter backend to give ability to switch:
				var webglBackend = new fabric.WebglFilterBackend();
				var canvas2dBackend = new fabric.Canvas2dFilterBackend()

				fabric.filterBackend = webglBackend;
				var $ = function(id) {
					return document.getElementById(id)
				};

				function applyFilter(index, filter) {
					var obj = canvas.getActiveObject();
					obj.filters[index] = filter;
					var timeStart = +new Date();
					obj.applyFilters();
					var timeEnd = +new Date();
					var dimString = canvas.getActiveObject().width + ' x ' +
						canvas.getActiveObject().height;
					$('bench').innerHTML = dimString + 'px ' +
						parseFloat(timeEnd - timeStart) + 'ms';
					canvas.renderAll();
				}

				function getFilter(index) {
					var obj = canvas.getActiveObject();
					return obj.filters[index];
				}

				function applyFilterValue(index, prop, value) {
					var obj = canvas.getActiveObject();
					if (obj.filters[index]) {
						obj.filters[index][prop] = value;
						var timeStart = +new Date();
						obj.applyFilters();
						var timeEnd = +new Date();
						var dimString = canvas.getActiveObject().width + ' x ' +
							canvas.getActiveObject().height;
						$('bench').innerHTML = dimString + 'px ' +
							parseFloat(timeEnd - timeStart) + 'ms';
						canvas.renderAll();
					}
				}

				fabric.Object.prototype.padding = 5;
				fabric.Object.prototype.transparentCorners = false;

				f = fabric.Image.filters;

				canvas.on({
					'object:selected': function() {


						var filters = ['grayscale', 'invert', 'remove-color', 'sepia', 'brownie',
							'brightness', 'contrast', 'saturation', 'noise', 'vintage',
							'pixelate', 'blur', 'sharpen', 'emboss', 'technicolor',
							'polaroid', 'blend-color', 'gamma', 'kodachrome',
							'blackwhite', 'blend-image', 'hue'
						];

						for (var i = 0; i < filters.length; i++) {
							filters[i] && (
								$(filters[i]).checked = !!canvas.getActiveObject().filters[i]);
						}
					},

				});

				fabric.Image.fromURL('images/woman.png', function(img) {
					var oImg = img.set({
						left: 0,
						top: 0
					}).scale(1);
					canvas.add(oImg);
				});
				var indexF;
				$('webgl').onclick = function() {
					if (this.checked) {
						fabric.filterBackend = webglBackend;
					} else {
						fabric.filterBackend = canvas2dBackend;
					}
				};
				$('brownie').onclick = function() {
					applyFilter(4, this.checked && new f.Brownie());
				};
				$('vintage').onclick = function() {
					applyFilter(9, this.checked && new f.Vintage());
				};
				$('technicolor').onclick = function() {
					applyFilter(14, this.checked && new f.Technicolor());
				};
				$('polaroid').onclick = function() {
					applyFilter(15, this.checked && new f.Polaroid());
				};
				$('kodachrome').onclick = function() {
					applyFilter(18, this.checked && new f.Kodachrome());
				};
				$('blackwhite').onclick = function() {
					applyFilter(19, this.checked && new f.BlackWhite());
				};
				$('grayscale').onclick = function() {
					applyFilter(0, this.checked && new f.Grayscale());
				};
				$('average').onclick = function() {
					applyFilterValue(0, 'mode', 'average');
				};
				$('luminosity').onclick = function() {
					applyFilterValue(0, 'mode', 'luminosity');
				};
				$('lightness').onclick = function() {
					applyFilterValue(0, 'mode', 'lightness');
				};
				$('invert').onclick = function() {
					applyFilter(1, this.checked && new f.Invert());
				};
				$('sepia').onclick = function() {
					applyFilter(3, this.checked && new f.Sepia());
				};
				$('brightness').onclick = function() {
					applyFilter(5, this.checked && new f.Brightness({
						brightness: parseFloat($('brightness-value').value)
					}));
				};
				$('brightness-value').oninput = function() {
					applyFilterValue(5, 'brightness', parseFloat(this.value));
				};
				$('contrast').onclick = function() {
					applyFilter(6, this.checked && new f.Contrast({
						contrast: parseFloat($('contrast-value').value)
					}));
				};
				$('contrast-value').oninput = function() {
					applyFilterValue(6, 'contrast', parseFloat(this.value));
				};
				$('saturation').onclick = function() {
					applyFilter(7, this.checked && new f.Saturation({
						saturation: parseFloat($('saturation-value').value)
					}));
				};
				$('saturation-value').oninput = function() {
					applyFilterValue(7, 'saturation', parseFloat(this.value));
				};
				$('noise').onclick = function() {
					applyFilter(8, this.checked && new f.Noise({
						noise: parseInt($('noise-value').value, 10)
					}));
				};
				$('noise-value').oninput = function() {
					applyFilterValue(8, 'noise', parseInt(this.value, 10));
				};
				$('blur').onclick = function() {
					applyFilter(11, this.checked && new f.Blur({
						value: parseFloat($('blur-value').value)
					}));
				};
				$('blur-value').oninput = function() {
					applyFilterValue(11, 'blur', parseFloat(this.value, 10));
				};

				$('blend').onclick = function() {
					applyFilter(16, this.checked && new f.BlendColor({
						color: document.getElementById('blend-color').value,
						mode: document.getElementById('blend-mode').value,
						alpha: document.getElementById('blend-alpha').value
					}));
				};

				$('blend-mode').onchange = function() {
					applyFilterValue(16, 'mode', this.value);
				};

				$('blend-color').onchange = function() {
					applyFilterValue(16, 'color', this.value);
				};

				$('blend-alpha').oninput = function() {
					applyFilterValue(16, 'alpha', this.value);
				};

				$('hue').onclick = function() {
					applyFilter(21, this.checked && new f.HueRotation({
						rotation: document.getElementById('hue-value').value,
					}));
				};

				$('hue-value').oninput = function() {
					applyFilterValue(21, 'rotation', this.value);
				};
		})();

	</script>
-->

	<!-- electron contextMenu test -->

	
	<script type="text/javascript">
	//		Create a context menu in electron

		const {
			remote
		} = require('electron')
		const {
			Menu, MenuItem
		} = remote

		const menu = new Menu()

		// Build menu one item at a time, unlike


		menu.append(new MenuItem({
			label: 'Send backwards',
			click() {
				sendBackwards()
			}
		}))
		menu.append(new MenuItem({
			label: 'Send to back',
			click() {
				sendToBack()
			}
		}))

		menu.append(new MenuItem({
			label: 'Bring forwards',
			click() {
				bringForward()
			}
		}))

		menu.append(new MenuItem({
			label: 'Bring to front',
			click() {
				bringToFront()
			}
		}))

		menu.append(new MenuItem({
			type: 'separator'
		}))

		menu.append(new MenuItem({
			label: 'Align',
			submenu: [{
				label: 'Left'
			}, {
				label: 'Center'
			}, {
				label: 'Right'
			}, {
				type: 'separator'
			}, {
				label: 'Top'
			}, {
				label: 'Middle'
			}, {
				label: 'Bottom'
			}]
		}))

		menu.append(new MenuItem({
			label: 'Distribute',
			submenu: [{
				label: 'Horizontal'
			}, {
				label: 'Vertical'
			}]
		}))


		menu.append(new MenuItem({
			type: 'separator'
		}))

		menu.append(new MenuItem({
			label: 'Group Selected',
			click() {}
		}))

		menu.append(new MenuItem({
			label: 'Ungroup Selected',
			click() {}
		}))

		menu.append(new MenuItem({
			type: 'separator'
		}))

		menu.append(new MenuItem({
			role: 'undo'
		}))

		menu.append(new MenuItem({
			role: 'redo'
		}))

		menu.append(new MenuItem({
			type: 'separator'
		}))

		menu.append(new MenuItem({
			role: 'cut'
		}))

		menu.append(new MenuItem({
			role: 'copy'
		}))

		menu.append(new MenuItem({
			role: 'paste'
		}))

		menu.append(new MenuItem({
			role: 'delete',
			click() {
				concole.log("should remove now")
				remove();
			}
		}))

		menu.append(new MenuItem({
			role: 'selectall'
		}))



		// Prevent default action of right click in chromium. Replace with our menu.
		window.addEventListener('contextmenu', (e) => {
			e.preventDefault()
			menu.popup(remote.getCurrentWindow())
		}, false)
	</script>


</body>

</html>